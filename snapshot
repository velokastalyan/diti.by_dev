#!/bin/bash
NAME="backup_$(date +%Y%m%d_%H%M%S)"
echo "üì¶ –°–æ–∑–¥–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–Ω—ç–ø—à–æ—Ç: $NAME..."

# –î–∞–º–ø –±–∞–∑—ã (–µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω)
docker exec -i $(docker ps -qf "name=db") mysqldump -u root -prootpassword user2160086_timistkas_sportmax > dump_temp.sql 2>/dev/null

# –ê—Ä—Ö–∏–≤–∞—Ü–∏—è (–∏—Å–∫–ª—é—á–∞—è —Ç—è–∂–µ–ª—ã–µ –ø–∞–ø–∫–∏ node_modules –∏ —Ç.–¥., –µ—Å–ª–∏ –ø–æ—è–≤—è—Ç—Å—è)
tar -czf backups/$NAME.tar.gz --exclude='backups' --exclude='.git' .

rm dump_temp.sql
echo "‚úÖ –°–Ω—ç–ø—à–æ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ backups/$NAME.tar.gz"
